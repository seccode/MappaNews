<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Mappa News</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<div id="map"></div>

<script>
	mapboxgl.accessToken='pk.eyJ1Ijoic2VjZmFzdCIsImEiOiJjanVlbGRxbTUwNGVlNDlwcXRxNnFhYnlzIn0.-dc9uxSNW4TUYbC96E8zjA';
    const map=new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v12',
        zoom: 5,
	center: [-74.5,40]
    });

    const images = {
        'popup': 'https://docs.mapbox.com/mapbox-gl-js/assets/popup.png',
    };

    loadImages(images, (loadedImages) => {
        map.on('load', () => {
            map.addImage('popup', loadedImages['popup'], {
                stretchX: [
                    [25, 55],
                    [85, 115]
                ],
                stretchY: [[25, 100]],
                content: [25, 25, 115, 100],
                pixelRatio: 2
            });

            map.addSource('points', {
                'type': 'geojson',
                'data': {
                    'type': 'FeatureCollection',
                    'features': [
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [126.9779692,37.566535]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/hyundai-integrated-its-crabwalking-e-corner-technology-into-an-ioniq-5-ev-190443090.html",
                                'name': "Engadget: Hyundai managed to..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-83.0457538,42.331427]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.theverge.com/23554163/chevy-corvette-e-ray-hybrid-awd-price-specs-photos",
                                'name': "The Verge: 2024 Chevy Corvett..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [2.3522219,48.856614]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/osmose-launch-170031918.html",
                                'name': "Engadget: Expressive E final..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-74.1502007,40.5795317]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/amazon-fails-to-overturn-staten-island-warehouse-vote-to-unionize-064010341.html",
                                'name': "Engadget: Amazon fails to ov..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-122.3320708,47.6062095]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://gizmodo.com/microsoft-ai-voice-mimic-deepfake-natural-copy-audio-1849969596",
                                'name': "Gizmodo.com: Microsoft's New AI..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-122.0321823,37.3229978]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/14-inch-macbook-pro-apple-deals-discount-amazon-best-buy-172511277.html",
                                'name': "Engadget: Apple's new 14-inc..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-121.5820708,47.278209499999996]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/amazon-expanded-job-cuts-18000-102059372.html",
                                'name': "Engadget: Amazon's expanded ..."
                            },
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-121.9499568,37.2871651]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/mercedes-and-chargepoint-team-up-to-build-400-north-american-hubs-171559321.html",
                                'name': "Engadget: Mercedes and Charg..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-121.93207079999999,47.3022095]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/amazon-rxpass-prime-generic-medications-5-a-month-103007949.html",
                                'name': "Engadget: Amazon's RxPass of..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-97.7430608,30.267153]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/teslas-long-range-model-y-may-not-qualify-for-the-ev-tax-credit-101229812.html",
                                'name': "Engadget: Tesla's Model Y co..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-123.0560708,47.5762095]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/amazon-shutting-down-amazonsmile-charity-program-061835108.html",
                                'name': "Engadget: Amazon is shutting..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-95.3698028,29.7604267]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.engadget.com/nasa-apollo-7-astronaut-walter-cunningham-obituary-171522792.html",
                                'name': "Engadget: Walter Cunningham,..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-122.3820708,47.2342095]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://gizmodo.com/amazons-buy-with-prime-coming-third-party-stores-u-s-1849969581",
                                'name': "Gizmodo.com: Amazon's 'Buy With..."
                            }
                        },
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'Point',
                                'coordinates': [-122.4194155,37.7749295]
                            },
                            'properties': {
                                'image-name': 'popup',
				'description': "https://www.bbc.co.uk/news/business-64371657",
                                'name': "BBC News: Subscription-based..."
                            }
                        },
                    ]
                }
            });
            map.addLayer({
                'id': 'points',
                'type': 'symbol',
                'source': 'points',
                'layout': {
                    'text-field': ['get', 'name'],
                    'icon-text-fit': 'both',
                    'icon-image': ['get', 'image-name'],
                    'icon-allow-overlap': true,
                    'text-allow-overlap': false
                }
            });
	    map.on('click', 'points', (e) => {
		const description = e.features[0].properties.description;
		window.open(description,"_blank").focus();
	    });

	    map.on('mouseenter', 'points', () => {
	        map.getCanvas().style.cursor = 'pointer'
	    })
	    map.on('mouseleave', 'points', () => {
	        map.getCanvas().style.cursor = ''
	    })
        });
    });

    function loadImages(urls, callback) {
        const results = {};
        for (const name in urls) {
            map.loadImage(urls[name], makeCallback(name));
        }

        function makeCallback(name) {
            return (err, image) => {
                results[name] = err ? null : image;

                // if all images are loaded, call the callback
                if (Object.keys(results).length === Object.keys(urls).length) {
                    callback(results);
                }
            };
        }
    }
</script>

</body>
</html>
